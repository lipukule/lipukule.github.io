function L(){}function ne(e){return e&&typeof e=="object"&&typeof e.then=="function"}function G(e){return e()}function B(){return Object.create(null)}function q(e){e.forEach(G)}function re(e){return typeof e=="function"}function be(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ae(e){return Object.keys(e).length===0}function Oe(e,t){e.appendChild(t)}function we(e,t,i){e.insertBefore(t,i||null)}function ie(e){e.parentNode.removeChild(e)}function ke(e){return document.createElement(e)}function z(e){return document.createTextNode(e)}function Pe(){return z(" ")}function Se(){return z("")}function Te(e,t,i,d){return e.addEventListener(t,i,d),()=>e.removeEventListener(t,i,d)}function Ee(e,t,i){i==null?e.removeAttribute(t):e.getAttribute(t)!==i&&e.setAttribute(t,i)}function ue(e){return Array.from(e.childNodes)}function Ue(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Re(e,t){e.value=t==null?"":t}function je(e,t,i,d){i===null?e.style.removeProperty(t):e.style.setProperty(t,i,d?"important":"")}let H;function E(e){H=e}function se(){if(!H)throw new Error("Function called outside component initialization");return H}const x=[],F=[],D=[],X=[],oe=Promise.resolve();let I=!1;function ce(){I||(I=!0,oe.then(J))}function A(e){D.push(e)}const N=new Set;let $=0;function J(){const e=H;do{for(;$<x.length;){const t=x[$];$++,E(t),fe(t.$$)}for(E(null),x.length=0,$=0;F.length;)F.pop()();for(let t=0;t<D.length;t+=1){const i=D[t];N.has(i)||(N.add(i),i())}D.length=0}while(x.length);for(;X.length;)X.pop()();I=!1,N.clear(),E(e)}function fe(e){if(e.fragment!==null){e.update(),q(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}const C=new Set;let U;function le(){U={r:0,c:[],p:U}}function de(){U.r||q(U.c),U=U.p}function K(e,t){e&&e.i&&(C.delete(e),e.i(t))}function he(e,t,i,d){if(e&&e.o){if(C.has(e))return;C.add(e),U.c.push(()=>{C.delete(e),d&&(i&&e.d(1),d())}),e.o(t)}}function qe(e,t){const i=t.token={};function d(v,h,_,y){if(t.token!==i)return;t.resolved=y;let p=t.ctx;_!==void 0&&(p=p.slice(),p[_]=y);const g=v&&(t.current=v)(p);let k=!1;t.block&&(t.blocks?t.blocks.forEach((w,f)=>{f!==h&&w&&(le(),he(w,1,1,()=>{t.blocks[f]===w&&(t.blocks[f]=null)}),de())}):t.block.d(1),g.c(),K(g,1),g.m(t.mount(),t.anchor),k=!0),t.block=g,t.blocks&&(t.blocks[h]=g),k&&J()}if(ne(e)){const v=se();if(e.then(h=>{E(v),d(t.then,1,t.value,h),E(null)},h=>{if(E(v),d(t.catch,2,t.error,h),E(null),!t.hasCatch)throw h}),t.current!==t.pending)return d(t.pending,0),!0}else{if(t.current!==t.then)return d(t.then,1,t.value,e),!0;t.resolved=e}}function He(e,t,i){const d=t.slice(),{resolved:v}=e;e.current===e.then&&(d[e.value]=v),e.current===e.catch&&(d[e.error]=v),e.block.p(d,i)}function pe(e,t,i,d){const{fragment:v,on_mount:h,on_destroy:_,after_update:y}=e.$$;v&&v.m(t,i),d||A(()=>{const p=h.map(G).filter(re);_?_.push(...p):q(p),e.$$.on_mount=[]}),y.forEach(A)}function ve(e,t){const i=e.$$;i.fragment!==null&&(q(i.on_destroy),i.fragment&&i.fragment.d(t),i.on_destroy=i.fragment=null,i.ctx=[])}function _e(e,t){e.$$.dirty[0]===-1&&(x.push(e),ce(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function xe(e,t,i,d,v,h,_,y=[-1]){const p=H;E(e);const g=e.$$={fragment:null,ctx:null,props:h,update:L,not_equal:v,bound:B(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(p?p.$$.context:[])),callbacks:B(),dirty:y,skip_bound:!1,root:t.target||p.$$.root};_&&_(g.root);let k=!1;if(g.ctx=i?i(e,t.props||{},(w,f,...n)=>{const a=n.length?n[0]:f;return g.ctx&&v(g.ctx[w],g.ctx[w]=a)&&(!g.skip_bound&&g.bound[w]&&g.bound[w](a),k&&_e(e,w)),f}):[],g.update(),k=!0,q(g.before_update),g.fragment=d?d(g.ctx):!1,t.target){if(t.hydrate){const w=ue(t.target);g.fragment&&g.fragment.l(w),w.forEach(ie)}else g.fragment&&g.fragment.c();t.intro&&K(e.$$.fragment),pe(e,t.target,t.anchor,t.customElement),J()}E(p)}class De{$destroy(){ve(this,1),this.$destroy=L}$on(t,i){const d=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return d.push(i),()=>{const v=d.indexOf(i);v!==-1&&d.splice(v,1)}}$set(t){this.$$set&&!ae(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function ye(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Q={},M={},W={};Object.defineProperty(W,"__esModule",{value:!0});var ge=function(){function e(t,i){var d=[],v=!0,h=!1,_=void 0;try{for(var y=t[Symbol.iterator](),p;!(v=(p=y.next()).done)&&(d.push(p.value),!(i&&d.length===i));v=!0);}catch(g){h=!0,_=g}finally{try{!v&&y.return&&y.return()}finally{if(h)throw _}}return d}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();W.getPagination=me;function me(e){var t=e.headers.get("Link"),i={};if(t==null)return null;t=t.split(",");for(var d=e.headers.get("X-Total-Count"),v=0,h=t.length;v<h;v++){var _=t[v].replace(/(^\s*|\s*$)/,""),y=_.split(";"),p=ge(y,2),g=p[0],k=p[1],w=g.match(/page=(\d+)/),f=w&&parseInt(w[1],10);k.match(/last/)?i.last=f:k.match(/next/)?i.next=f:k.match(/prev/)?i.prev=f:k.match(/first/)&&(i.first=f)}return i.last=Math.max(i.last||0,i.prev&&i.prev+1||0),i.current=i.next?i.next-1:i.last||1,i.total=d?parseInt(d,10):null,i}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.JSONHTTPError=e.TextHTTPError=e.HTTPError=e.getPagination=void 0;var t=Object.assign||function(f){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(f[r]=a[r])}return f},i=function(){function f(n,a){for(var r=0;r<a.length;r++){var u=a[r];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}return function(n,a,r){return a&&f(n.prototype,a),r&&f(n,r),n}}(),d=W;Object.defineProperty(e,"getPagination",{enumerable:!0,get:function(){return d.getPagination}});function v(f,n){if(!(f instanceof n))throw new TypeError("Cannot call a class as a function")}function h(f,n){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:f}function _(f,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);f.prototype=Object.create(n&&n.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(f,n):f.__proto__=n)}function y(f){function n(){var a=Reflect.construct(f,Array.from(arguments));return Object.setPrototypeOf(a,Object.getPrototypeOf(this)),a}return n.prototype=Object.create(f.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(n,f):n.__proto__=f,n}var p=e.HTTPError=function(f){_(n,f);function n(a){v(this,n);var r=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,a.statusText));return r.name=r.constructor.name,typeof Error.captureStackTrace=="function"?Error.captureStackTrace(r,r.constructor):r.stack=new Error(a.statusText).stack,r.status=a.status,r}return n}(y(Error)),g=e.TextHTTPError=function(f){_(n,f);function n(a,r){v(this,n);var u=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,a));return u.data=r,u}return n}(p),k=e.JSONHTTPError=function(f){_(n,f);function n(a,r){v(this,n);var u=h(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,a));return u.json=r,u}return n}(p),w=function(){function f(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments[1];v(this,f),this.apiURL=n,this.apiURL.match(/\/[^\/]?/)&&(this._sameOrigin=!0),this.defaultHeaders=a&&a.defaultHeaders||{}}return i(f,[{key:"headers",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t({},this.defaultHeaders,{"Content-Type":"application/json"},a)}},{key:"parseJsonResponse",value:function(a){return a.json().then(function(r){if(!a.ok)return Promise.reject(new k(a,r));var u=(0,d.getPagination)(a);return u?{pagination:u,items:r}:r})}},{key:"request",value:function(a){var r=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=this.headers(u.headers||{});return this._sameOrigin&&(u.credentials=u.credentials||"same-origin"),fetch(this.apiURL+a,t({},u,{headers:O})).then(function(m){var P=m.headers.get("Content-Type");return P&&P.match(/json/)?r.parseJsonResponse(m):m.ok?m.text().then(function(R){}):m.text().then(function(R){return Promise.reject(new g(m,R))})})}}]),f}();e.default=w})(M);var V={},Y={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function t(h,_){if(!(h instanceof _))throw new TypeError("Cannot call a class as a function")}function i(h,_){for(var y=0;y<_.length;y++){var p=_[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}function d(h,_,y){return _&&i(h.prototype,_),y&&i(h,y),h}var v=function(){function h(_){t(this,h),this.user=_}return d(h,[{key:"listUsers",value:function(y){return this.user._request("/admin/users",{method:"GET",audience:y})}},{key:"getUser",value:function(y){return this.user._request("/admin/users/".concat(y.id))}},{key:"updateUser",value:function(y){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.user._request("/admin/users/".concat(y.id),{method:"PUT",body:JSON.stringify(p)})}},{key:"createUser",value:function(y,p){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return g.email=y,g.password=p,this.user._request("/admin/users",{method:"POST",body:JSON.stringify(g)})}},{key:"deleteUser",value:function(y){return this.user._request("/admin/users/".concat(y.id),{method:"DELETE"})}}]),h}();e.default=v})(Y);(function(e){function t(o){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(s){return typeof s}:t=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t(o)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=_(M),d=v(Y);function v(o){return o&&o.__esModule?o:{default:o}}function h(){if(typeof WeakMap!="function")return null;var o=new WeakMap;return h=function(){return o},o}function _(o){if(o&&o.__esModule)return o;if(o===null||t(o)!=="object"&&typeof o!="function")return{default:o};var c=h();if(c&&c.has(o))return c.get(o);var s={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in o)if(Object.prototype.hasOwnProperty.call(o,b)){var S=l?Object.getOwnPropertyDescriptor(o,b):null;S&&(S.get||S.set)?Object.defineProperty(s,b,S):s[b]=o[b]}return s.default=o,c&&c.set(o,s),s}function y(o,c){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(o);c&&(l=l.filter(function(b){return Object.getOwnPropertyDescriptor(o,b).enumerable})),s.push.apply(s,l)}return s}function p(o){for(var c=1;c<arguments.length;c++){var s=arguments[c]!=null?arguments[c]:{};c%2?y(Object(s),!0).forEach(function(l){g(o,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach(function(l){Object.defineProperty(o,l,Object.getOwnPropertyDescriptor(s,l))})}return o}function g(o,c,s){return c in o?Object.defineProperty(o,c,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[c]=s,o}function k(o,c){if(!(o instanceof c))throw new TypeError("Cannot call a class as a function")}function w(o,c){for(var s=0;s<c.length;s++){var l=c[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function f(o,c,s){return c&&w(o.prototype,c),s&&w(o,s),o}var n=60*1e3,a="gotrue.user",r={},u=null,O={api:1,token:1,audience:1,url:1},m={api:1},P=function(){return typeof window!="undefined"},R=function(){function o(c,s,l){k(this,o),this.api=c,this.url=c.apiURL,this.audience=l,this._processTokenResponse(s),u=this}return f(o,[{key:"update",value:function(s){var l=this;return this._request("/user",{method:"PUT",body:JSON.stringify(s)}).then(function(b){return l._saveUserData(b)._refreshSavedSession()})}},{key:"jwt",value:function(s){var l=this.tokenDetails();if(l==null)return Promise.reject(new Error("Gotrue-js: failed getting jwt access token"));var b=l.expires_at,S=l.refresh_token,j=l.access_token;return s||b-n<Date.now()?this._refreshToken(S):Promise.resolve(j)}},{key:"logout",value:function(){return this._request("/logout",{method:"POST"}).then(this.clearSession.bind(this)).catch(this.clearSession.bind(this))}},{key:"_refreshToken",value:function(s){var l=this;return r[s]?r[s]:r[s]=this.api.request("/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=refresh_token&refresh_token=".concat(s)}).then(function(b){return delete r[s],l._processTokenResponse(b),l._refreshSavedSession(),l.token.access_token}).catch(function(b){return delete r[s],l.clearSession(),Promise.reject(b)})}},{key:"_request",value:function(s){var l=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};b.headers=b.headers||{};var S=b.audience||this.audience;return S&&(b.headers["X-JWT-AUD"]=S),this.jwt().then(function(j){return l.api.request(s,p({headers:Object.assign(b.headers,{Authorization:"Bearer ".concat(j)})},b)).catch(function(T){return T instanceof i.JSONHTTPError&&T.json&&(T.json.msg?T.message=T.json.msg:T.json.error&&(T.message="".concat(T.json.error,": ").concat(T.json.error_description))),Promise.reject(T)})})}},{key:"getUserData",value:function(){return this._request("/user").then(this._saveUserData.bind(this)).then(this._refreshSavedSession.bind(this))}},{key:"_saveUserData",value:function(s,l){for(var b in s)b in o.prototype||b in O||(this[b]=s[b]);return l&&(this._fromStorage=!0),this}},{key:"_processTokenResponse",value:function(s){this.token=s;try{var l=JSON.parse(Z(s.access_token.split(".")[1]));this.token.expires_at=l.exp*1e3}catch(b){console.error(new Error("Gotrue-js: Failed to parse tokenResponse claims: ".concat(b)))}}},{key:"_refreshSavedSession",value:function(){return P()&&localStorage.getItem(a)&&this._saveSession(),this}},{key:"_saveSession",value:function(){return P()&&localStorage.setItem(a,JSON.stringify(this._details)),this}},{key:"tokenDetails",value:function(){return this.token}},{key:"clearSession",value:function(){o.removeSavedSession(),this.token=null,u=null}},{key:"admin",get:function(){return new d.default(this)}},{key:"_details",get:function(){var s={};for(var l in this)l in o.prototype||l in m||(s[l]=this[l]);return s}}],[{key:"removeSavedSession",value:function(){P()&&localStorage.removeItem(a)}},{key:"recoverSession",value:function(s){if(u)return u;var l=P()&&localStorage.getItem(a);if(l)try{var b=JSON.parse(l),S=b.url,j=b.token,T=b.audience;if(!S||!j)return null;var ee=s||new i.default(S,{});return new o(ee,j,T)._saveUserData(b,!0)}catch(te){return console.error(new Error("Gotrue-js: Error recovering session: ".concat(te))),null}return null}}]),o}();e.default=R;function Z(o){var c=o.replace(/-/g,"+").replace(/_/g,"/");switch(c.length%4){case 0:break;case 2:c+="==";break;case 3:c+="=";break;default:throw"Illegal base64url string!"}var s=window.atob(c);try{return decodeURIComponent(escape(s))}catch{return s}}})(V);(function(e){function t(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(r){return typeof r}:t=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t(n)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=_(M),d=v(V);function v(n){return n&&n.__esModule?n:{default:n}}function h(){if(typeof WeakMap!="function")return null;var n=new WeakMap;return h=function(){return n},n}function _(n){if(n&&n.__esModule)return n;if(n===null||t(n)!=="object"&&typeof n!="function")return{default:n};var a=h();if(a&&a.has(n))return a.get(n);var r={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in n)if(Object.prototype.hasOwnProperty.call(n,O)){var m=u?Object.getOwnPropertyDescriptor(n,O):null;m&&(m.get||m.set)?Object.defineProperty(r,O,m):r[O]=n[O]}return r.default=n,a&&a.set(n,r),r}function y(n,a){if(!(n instanceof a))throw new TypeError("Cannot call a class as a function")}function p(n,a){for(var r=0;r<a.length;r++){var u=a[r];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}function g(n,a,r){return a&&p(n.prototype,a),r&&p(n,r),n}var k=/^http:\/\//,w="/.netlify/identity",f=function(){function n(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=a.APIUrl,u=r===void 0?w:r,O=a.audience,m=O===void 0?"":O,P=a.setCookie,R=P===void 0?!1:P;y(this,n),u.match(k)&&console.warn(`Warning:

DO NOT USE HTTP IN PRODUCTION FOR GOTRUE EVER!
GoTrue REQUIRES HTTPS to work securely.`),m&&(this.audience=m),this.setCookie=R,this.api=new i.default(u)}return g(n,[{key:"_request",value:function(r){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.headers=u.headers||{};var O=u.audience||this.audience;return O&&(u.headers["X-JWT-AUD"]=O),this.api.request(r,u).catch(function(m){return m instanceof i.JSONHTTPError&&m.json&&(m.json.msg?m.message=m.json.msg:m.json.error&&(m.message="".concat(m.json.error,": ").concat(m.json.error_description))),Promise.reject(m)})}},{key:"settings",value:function(){return this._request("/settings")}},{key:"signup",value:function(r,u,O){return this._request("/signup",{method:"POST",body:JSON.stringify({email:r,password:u,data:O})})}},{key:"login",value:function(r,u,O){var m=this;return this._setRememberHeaders(O),this._request("/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=password&username=".concat(encodeURIComponent(r),"&password=").concat(encodeURIComponent(u))}).then(function(P){return d.default.removeSavedSession(),m.createUser(P,O)})}},{key:"loginExternalUrl",value:function(r){return"".concat(this.api.apiURL,"/authorize?provider=").concat(r)}},{key:"confirm",value:function(r,u){return this._setRememberHeaders(u),this.verify("signup",r,u)}},{key:"requestPasswordRecovery",value:function(r){return this._request("/recover",{method:"POST",body:JSON.stringify({email:r})})}},{key:"recover",value:function(r,u){return this._setRememberHeaders(u),this.verify("recovery",r,u)}},{key:"acceptInvite",value:function(r,u,O){var m=this;return this._setRememberHeaders(O),this._request("/verify",{method:"POST",body:JSON.stringify({token:r,password:u,type:"signup"})}).then(function(P){return m.createUser(P,O)})}},{key:"acceptInviteExternalUrl",value:function(r,u){return"".concat(this.api.apiURL,"/authorize?provider=").concat(r,"&invite_token=").concat(u)}},{key:"createUser",value:function(r){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this._setRememberHeaders(u);var O=new d.default(this.api,r,this.audience);return O.getUserData().then(function(m){return u&&m._saveSession(),m})}},{key:"currentUser",value:function(){var r=d.default.recoverSession(this.api);return r&&this._setRememberHeaders(r._fromStorage),r}},{key:"verify",value:function(r,u,O){var m=this;return this._setRememberHeaders(O),this._request("/verify",{method:"POST",body:JSON.stringify({token:u,type:r})}).then(function(P){return m.createUser(P,O)})}},{key:"_setRememberHeaders",value:function(r){this.setCookie&&(this.api.defaultHeaders=this.api.defaultHeaders||{},this.api.defaultHeaders["X-Use-Cookie"]=r?"1":"session")}}]),n}();e.default=f,typeof window!="undefined"&&(window.GoTrue=f)})(Q);var $e=ye(Q);export{$e as G,De as S,we as a,ke as b,Pe as c,ie as d,Se as e,Ee as f,je as g,qe as h,xe as i,Oe as j,Re as k,Te as l,Ue as m,L as n,q as r,be as s,z as t,He as u};
